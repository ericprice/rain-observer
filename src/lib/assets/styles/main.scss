// Import partial files (Sass modules)
@use 'reset';
@use 'fonts';

body,
html {
  overflow: hidden;
}

body {
  font-family: 'Monument Grotesk';
  font-size: 5vw;
  line-height: .95em;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  color: #f20;
  text-shadow: .05em .05em 0 #000;
  -webkit-text-stroke: .0125em #fd0;
  font-feature-settings: "ss01" 1, "ss03" 1;
}

@media (screen and min-width: 768px) {
  body {
    font-size: 3vw;
    line-height: .95em;
  }
}

.webcam-container {
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;
}

.webcam-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.weather-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  padding: .125em;
  z-index: 3;
}

.progress-bottom {
  position: absolute;
  left: .2em;
  right: .2em;
  bottom: .125em;
  height: .1em;
  z-index: 5;
  pointer-events: none;
}

.progress-fill {
  height: 100%;
  background: #f20;
  transform-origin: left center;
  transition: transform 0.1s linear;
  will-change: transform;
  border: .0125em solid #fd0;
  box-shadow: .05em .05em 0 #000;
}

@media (prefers-reduced-motion: reduce) {
  .raindrops-overlay { display: none; }
  .progress-fill { transition: none; }
}

/* Fade non-location parts of the overlay on idle */
.weather-overlay .weather-content > :not(.location-name) {
  /* no transition here so returning from idle is instant */
}

.webcam-container.idle .weather-overlay .weather-content > :not(.location-name) {
  opacity: 0;
}

/* Layering: webcam image < raindrops (2) < weather overlay (3) < progress (5) */

/* Raindrops layering and animation */
.raindrops-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 2;
}

.raindrop {
  position: absolute;
  border-radius: 50%;
  /* subtle lens effect */
  backdrop-filter: blur(.6em) saturate(170%) contrast(130%);
  -webkit-backdrop-filter: blur(.6em) saturate(170%) contrast(130%);
  background: radial-gradient(closest-side, rgba(255,255,255,.25), rgba(255,255,255,.15) 60%, rgba(255,255,255,.07) 80%, rgba(255,255,255,0) 90%);
  box-shadow: inset 0 .02em .2em rgba(255,255,255,.5), inset 0 -.03em .3em rgba(0,0,0,.3);
  will-change: transform;
  animation: raindrop-fall var(--fallMs, 2800ms) cubic-bezier(.5,0,1,1) forwards;
}

/* Quick expanding splash ring on impact */
.raindrop::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  transform: translate(-50%, -50%) scale(.4);
  border: .06em solid rgba(255,255,255,.55);
  box-shadow: 0 0 .12em rgba(255,255,255,.5);
  opacity: .9;
  pointer-events: none;
  animation: raindrop-splash 220ms ease-out forwards;
}

@keyframes raindrop-splash {
  0% { transform: translate(-50%, -50%) scale(.4); opacity: .9; }
  60% { transform: translate(-50%, -50%) scale(1.6); opacity: .45; }
  100% { transform: translate(-50%, -50%) scale(2.2); opacity: 0; }
}

@keyframes raindrop-fall {
  0% {
    transform: translateY(0) scale(.94);
    opacity: .96;
  }
  4% {
    transform: translateY(0) scale(1.1);
  }
  6% {
    transform: translateY(0) scale(1);
  }
  100% {
    transform: translateY(var(--fall, 100vh)) scale(1);
    opacity: .85;
  }
}

